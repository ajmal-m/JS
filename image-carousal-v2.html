<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Carousal</title>
    <style>
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        .container{
            width: 100vw ;
            height: 100vh;
            background: rgb(26, 25, 25);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .carousel-container{
            width: 300px;
            height: 300px;
            border: 1px solid white;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .carousel{
            display: grid;
            grid-template-columns: repeat(4, 298px);
            height: 100%;
            transition: transform 0.3s ease-in;
            font-size: 24px;
            font-weight: 800;
            transform: translateX(-298px);
        }

        .carousel img{
            width: 298px;
            height: 300px;
        }

        .btn{
            position: absolute;
            top: 50%;
            padding: 2px 4px;
            font-size: 12px;
            border-radius: 4px;
            color: rgb(0, 0, 0); 
            cursor: pointer;
        }
        .next-btn{
            right: 0;
        }
        .carousel-item{
            display: flex;
            text-align: center;
            color: white;
            background: mediumvioletred;
            font-size: 23px;
            align-items: center;
            justify-content: center;
            width: 298px;
            height: 298px;
        }

        .animation{
            transition: transform 0.3s ease-in;
        }

        .carousel-item img{
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .show{
            opacity: 1;
        }
        .hide{
            opacity: 0;
        }

        .carousel-item-prev{
            background-color: blue;
        }

        .carousel-item-curr{
            background-color: blueviolet;
        }

        .carousel-item-next{
            background-color: brown;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="carousel-container">
            <div class="carousel">
                <div class="carousel-item carousel-item-prev">
                    <img src="" alt="" srcset="">
                </div>
                <div class="carousel-item carousel-item-curr">
                     <img src="" alt="" srcset="">
                </div>
                <div class="carousel-item carousel-item-next">
                     <img src="" alt="" srcset="">
                </div>
            </div>
            <button class="btn next-btn">Next</button>
            <button class="btn prev-btn">Prev</button>
        </div>
    </div>
    <script>

         let carouselItems = [
            'https://thumbs.dreamstime.com/b/red-apple-isolated-clipping-path-19130134.jpg',
            'https://media.istockphoto.com/id/804495812/vector/yellow-not-peeled-banana.jpg?s=612x612&w=0&k=20&c=cv7wUTj9DF_au1biwWb27c09G_a-9F2KpRhgP_sth80=',
            'https://img.freepik.com/free-photo/portrait-beautiful-purebred-pussycat-with-shorthair-orange-collar-neck-sitting-floor-reacting-camera-flash-scared-looking-light-indoor_8353-12551.jpg?semt=ais_hybrid&w=740&q=80',
            'https://hips.hearstapps.com/hmg-prod/images/dog-puppy-on-garden-royalty-free-image-1586966191.jpg?crop=0.752xw:1.00xh;0.175xw,0&resize=1200:*',
            'https://images.unsplash.com/photo-1581852017103-68ac65514cf7?fm=jpg&q=60&w=3000&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8ZWxlcGhhbnR8ZW58MHx8MHx8fDA%3D',
            'https://images.pexels.com/photos/128756/pexels-photo-128756.jpeg?cs=srgb&dl=pexels-cubir-128756.jpg&fm=jpg'
        ]

        let move = {
            next:{
                pcn:{
                    nodelay:[
                        {
                            type: "c",
                            x: -298,
                        },
                        {
                            type:"n",
                            x: -298
                        }
                    ],
                    delay:{
                        type: "p",
                        x: 298*2
                    }
                },
                npc:{
                    nodelay:[
                        {
                            type: "c",
                            x: 0,
                        },
                        {
                            type:"p",
                            x: 0
                        }
                    ],
                    delay:{
                        type: "n",
                        x:0
                    }
                },
                cnp:{
                    nodelay:[
                        {
                            type: "n",
                            x: -298*2,
                        },
                        {
                            type:"p",
                            x: 298
                        }
                    ],
                    delay:{
                        type: "c",
                        x: 298
                    }
                }
            },

            prev:{
                pcn:{
                    nodelay:[
                        {
                            type: "c",
                            x: 298,
                        },
                        {
                            type:"p",
                            x: 298
                        }
                    ],
                    delay:{
                        type: "n",
                        x: -298*2
                    }
                },
                npc:{
                    nodelay:[
                        {
                            type: "p",
                            x: 2*298,
                        },
                        {
                            type:"n",
                            x: -298
                        }
                    ],
                    delay:{
                        type: "c",
                        x: -298
                    }
                },
                cnp:{
                    nodelay:[
                        {
                            type: "c",
                            x: 0,
                        },
                        {
                            type:"n",
                            x: 0
                        }
                    ],
                    delay:{
                        type: "p",
                        x: 0
                    }
                }
            }
        }
        const delayTime = 300;
        let len = carouselItems.length;

        let secondCarousal = 0 %len;
        let thirdCarousal = (secondCarousal+1)%len;
        let firstCarousal = (secondCarousal-1+len)%len;

        let loading = false;

        let prev = -1;
        let curr = 0;
        let next = 1;

        const nextBtn = document.querySelector(".next-btn");
        const prevBtn = document.querySelector(".prev-btn");

        const carousel = document.querySelector(".carousel");

        const prevCarousalElem = document.querySelector(".carousel-item-prev");
        const currCarousalElem = document.querySelector(".carousel-item-curr");
        const nextCarousalElem = document.querySelector(".carousel-item-next");

        let carousalElem = {
            p: prevCarousalElem,
            c: currCarousalElem,
            n: nextCarousalElem
        }



        nextBtn.addEventListener("click", () => {
          nextUpdate();
        });

        prevBtn.addEventListener("click", () => {
            prevUpdate();
        });

        const nextUpdate = async ( ) => {
            if(loading) return;
            loading = true;
            firstCarousal = secondCarousal;
            secondCarousal = thirdCarousal;
            thirdCarousal = (secondCarousal+1)%len;
            console.log(
                "First : ", firstCarousal,
                "Second : ", secondCarousal,
                "Third : ", thirdCarousal
            )
            if( prev === -1 && curr === 0 && next === 1  ){
                moveCarousal(move.next.pcn , "next");
                prev = 1;
                next =0;
                curr=-1;
            }else if( next === -1 && prev === 0 && curr === 1 ){
                moveCarousal(move.next.npc , "next");
                prev = -1;
                curr = 0;
                next = 1;
            }else if( curr == -1 && next == 0 && prev == 1 ){
                moveCarousal(move.next.cnp , "next" );
                next = -1;
                prev = 0;
                curr = 1;
            }
            loading = false;
        }

         const prevUpdate = (  ) => {
            thirdCarousal = secondCarousal;
            secondCarousal = firstCarousal;
            firstCarousal = (secondCarousal - 1 + len) % len;
            console.log(
                "First : ", firstCarousal,
                "Second : ", secondCarousal,
                "Third : ", thirdCarousal
            )
            if( prev === -1 && curr === 0 && next === 1  ){
                moveCarousal(move.prev.pcn ,  "prev");
                prev = 0;
                next =-1;
                curr=1;
            }else if( next === -1 && prev === 0 && curr === 1 ){
                moveCarousal(move.prev.npc ,  "prev");

                prev = 1;
                curr = -1;
                next = 0;
            }else if( curr == -1 && next == 0 && prev == 1 ){
                moveCarousal(move.prev.cnp , "prev");

                next = 1;
                prev = -1;
                curr = 0;
            }
        }

        const updateAsset = (type , carousalType) => {
            const carousalElemItem = carousalElem[carousalType];
            if(type == "next"){
                carousalElemItem.querySelector("img").src = carouselItems[thirdCarousal];
            }else{
                carousalElemItem.querySelector("img").src = carouselItems[firstCarousal];
            }
        };

        const moveCarousal = async (obj , type) => {
            const nodelayArray = obj.nodelay;
            const delayObj = obj.delay;

            carousalElem[delayObj.type].style.zIndex = '0';

            for(let item of nodelayArray){
                carousalElem[item.type].classList.add("animation");
                carousalElem[item.type].style.transform = `translateX(${item.x}px)`;
                setTimeout(() => {
                    carousalElem[item.type].classList.remove("animation");
                },300)
            }
            carousalElem[delayObj.type].style.transform = `translateX(${delayObj.x}px)`;
            updateAsset( type , delayObj.type);
        };


        const delay = async (time) => {
            return new Promise((resolve) => {
                setTimeout(() => {
                    resolve(true);
                }, time);
            })
        }


        const initialUIUpdate = () => {
            carousalElem.p.querySelector("img").src = carouselItems[firstCarousal];
            carousalElem.c.querySelector("img").src = carouselItems[secondCarousal];
            carousalElem.n.querySelector("img").src = carouselItems[thirdCarousal];
        }

        initialUIUpdate();
    
    </script>
</body>
</html>